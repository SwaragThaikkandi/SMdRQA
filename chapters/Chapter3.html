
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 3- False Nearest Neighbours and Embedding Dimensions &#8212; SMdRQA 2024.04.01 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=d6f9e291"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Chapter3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 4- Recurrence Plot and Recurrence Quantification Analysis" href="Chapter4.html" />
    <link rel="prev" title="Chapter 2- Taken’s Theorm and Time Delayed Embedding" href="Chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">SMdRQA 2024.04.01 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Menu</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">SMdRQA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite_us.html">Cite us</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Chapters</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Chapter1.html">Chapter 1- The Nonlinear World</a></li>
<li class="toctree-l2"><a class="reference internal" href="Chapter2.html">Chapter 2- Taken’s Theorm and Time Delayed Embedding</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Chapter 3- False Nearest Neighbours and Embedding Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Chapter4.html">Chapter 4- Recurrence Plot and Recurrence Quantification Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/kuramoto.html">Kuramoto Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/rossler.html">Rossler Attractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/koul_et_al.html">Data from Koul et al(2023)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/troubleshoot-parameter.html">Troubleshooting: Parameter Search for embedding dimension</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../functions/index.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../functions/nl_tests.html">nl_tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/RQA_functions.html">RQA_functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/RP_maker.html">RP_maker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/window_size.html">window_size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/Extract_from_RP.html">Extract_from_RP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/RP_maker_diagnose.html">RP_maker_diagnose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/cross_validation.html">cross_validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions/utils.html">Utility Functions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../repo_details.html">Repository Information</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SwaragThaikkandi/SMdRQA">Repository</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SwaragThaikkandi/SMdRQA" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SwaragThaikkandi/SMdRQA/edit/main/docs/chapters/Chapter3.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SwaragThaikkandi/SMdRQA/issues/new?title=Issue%20on%20page%20%2Fchapters/Chapter3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/Chapter3.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 3- False Nearest Neighbours and Embedding Dimensions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest"><em>nearest()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.nearest"><code class="docutils literal notranslate"><span class="pre">nearest()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fnnhitszero"><em>fnnhitszero()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.fnnhitszero"><code class="docutils literal notranslate"><span class="pre">fnnhitszero()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#findm"><em>findm()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.findm"><code class="docutils literal notranslate"><span class="pre">findm()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="chapter-3-false-nearest-neighbours-and-embedding-dimensions">
<h1>Chapter 3- False Nearest Neighbours and Embedding Dimensions<a class="headerlink" href="#chapter-3-false-nearest-neighbours-and-embedding-dimensions" title="Link to this heading">#</a></h1>
<p>We employed a technique known as false nearest neighbors (FNN), introduced by Kennel et al.(1992), to ascertain the minimum number of dimensions needed to faithfully reconstruct an attractor. An attractor serves as a representation of how a system evolves over time.</p>
<p>In our analysis, our goal was to ensure that when we represent this evolution in lower dimensions, we do not lose crucial details. False nearest neighbors play a crucial role in this determination. They are points that may seem close together in a lower-dimensional depiction but are actually distant in the original higher-dimensional space.</p>
<p>To illustrate, consider trying to draw a detailed picture of a tree on a small piece of paper. You might find it challenging to capture all the branches and leaves due to space constraints. Similarly, in our analysis, starting with a lower-dimensional representation of the system’s behavior may obscure important details. This situation is akin to trying to fit a detailed tree drawing on a tiny piece of paper – some parts may appear connected, but they are distinct.</p>
<p>Identifying many false nearest neighbors suggests that our lower-dimensional representation lacks essential information. Increasing the dimensions allows us to “unfold” the attractor and separate these falsely identified neighbors. This process ensures that our representation accurately captures the system’s dynamics. Hence, false nearest neighbors serve as a guide to determine if our chosen dimensions adequately represent the complete picture of the system’s behavior over time.</p>
<p>In simpler terms, let’s say we have a time series with an ideal embedding dimension of <span class="math notranslate nohighlight">\(m_0\)</span>. When we reduce the dimension by one, some points are strongly affected and become false nearest neighbors (FNN). To identify these FNN points, we compared the distances between points in the <span class="math notranslate nohighlight">\(m\)</span>-dimensional space with those in the <span class="math notranslate nohighlight">\(m+1\)</span>-dimensional space and calculated their ratio.</p>
<div class="math notranslate nohighlight">
\[X_{fnn}(r) = \frac{\sum_{n=1}^{N-m-1} \Theta\left(\frac{|x_n^{(m+1)}-x_{k(n)}^{(m+1)}|}{|x_n^{(m)}-x_{k(n)}^{(m)}|}-r\right) \Theta\left(\frac{\sigma}{r}-|x_n^{(m)}-x_{k(n)}^{(m)}|\right)}{\sum_{n=1}^{N-m-1}\Theta\left(\frac{\sigma}{r}-|x_n^{(m)}-x_{k(n)}^{(m)}|\right)}\]</div>
<p>Where :math:` x_{k(n)}^{(m)}` represents the nearest neighbor of <span class="math notranslate nohighlight">\(x_n^{(m)}\)</span> in <span class="math notranslate nohighlight">\(m\)</span> dimensions, and <span class="math notranslate nohighlight">\(\Theta(x)\)</span> denotes the Heaviside step function. <span class="math notranslate nohighlight">\(\sigma\)</span> signifies the standard deviation of the data. The function <span class="math notranslate nohighlight">\(k(n)\)</span> is defined as follows:</p>
<div class="math notranslate nohighlight">
\[k(n) = \{ n' \mid |x_n^{(m)} - x_{n'}^{(m)}| \leq |x_n^{(m)} - x_{n''}^{(m)}|, \forall n'' \in I(x) - n \}\]</div>
<p>where <span class="math notranslate nohighlight">\(I(x)\)</span> is the set of all indices of x. k(n) is estimated using <strong>nearest()</strong> function in the package</p>
<section id="nearest">
<h2><em>nearest()</em><a class="headerlink" href="#nearest" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMdRQA.RQA_functions.nearest">
<span class="sig-name descname"><span class="pre">nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SMdRQA/RQA_functions.html#nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMdRQA.RQA_functions.nearest" title="Link to this definition">#</a></dt>
<dd><p>Function that would give a nearest neighbour map, the output array(nn) stores indices of nearest neighbours for index values of each observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>ndarray</em>) – 3D matrix ov size ((n-(m-1)*tau,m,d)), time delayed embedded signal</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of samples or observations in the time series</p></li>
<li><p><strong>d</strong> (<em>int</em>) – number of measurements or dimensions of the data</p></li>
<li><p><strong>tau</strong> (<em>int</em>) – amount of delay</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of embedding dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nn</strong> (<em>array</em>) – an array denoting index of nearest neighbour for each observation</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Takens, F. (1981). Dynamical systems and turbulence. Warwick, 1980, 366–381.</p></li>
</ul>
</dd></dl>

<p>A more appropriate method would be to see the FNN ratio as a function of r (see Kantz and Schreiber(2004), section 3.3.1, page 37, figure 3.3)) if we are interested in parameter exploration.</p>
<p>For this we defined the radius at which FNN hist zero as:</p>
<div class="math notranslate nohighlight">
\[r_0(m) = \{ r \mid X_{fnn}(r) &lt; \delta, \forall r \in [r_{\min}, r_{\max}] \}\]</div>
<p>Where <span class="math notranslate nohighlight">\([r_{min},r_{max}]\)</span> is the interval where we are searching, which is for m embedding dimensions, and <span class="math notranslate nohighlight">\(\delta\)</span> is a small enough number. This was implemented using the function <strong>fnnhitszero()</strong></p>
</section>
<section id="fnnhitszero">
<h2><em>fnnhitszero()</em><a class="headerlink" href="#fnnhitszero" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMdRQA.RQA_functions.fnnhitszero">
<span class="sig-name descname"><span class="pre">fnnhitszero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdiv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SMdRQA/RQA_functions.html#fnnhitszero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMdRQA.RQA_functions.fnnhitszero" title="Link to this definition">#</a></dt>
<dd><p>Function that finds the value of r at which the FNN ratio can be effectively considered as zero</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>ndarray</em>) – double array of shape (n,d).  Think of it as n points in a d dimensional space</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of samples or observations in the time series</p></li>
<li><p><strong>d</strong> (<em>int</em>) – number of measurements or dimensions of the data</p></li>
<li><p><strong>tau</strong> (<em>int</em>) – amount of delay</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of embedding dimensions</p></li>
<li><p><strong>r</strong> (<em>double</em>) – ratio parameter</p></li>
<li><p><strong>sig</strong> (<em>double</em>) – standard deviation of the data</p></li>
<li><p><strong>delta</strong> (<em>double</em>) – the tolerance value(the maximum difference from zero) for a value of FNN ratio to be effectively considered to be zero</p></li>
<li><p><strong>Rmin</strong> (<em>double</em>) – minimum value of r from where we would start the parameter search</p></li>
<li><p><strong>Rmax</strong> (<em>double</em>) – maximum value of r for defining the upper limit of parameter search</p></li>
<li><p><strong>rdiv</strong> (<em>Int</em>) – number of divisions between Rmin and Rmax for parameter search</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r</strong> (<em>double</em>) – value of r at which the value of FNN ratio effectively hits zero</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Kantz, H., &amp; Schreiber, T. (2004). Nonlinear time series analysis (Vol. 7). Cambridge university press. section 3.3.1</p></li>
</ul>
</dd></dl>

<p>When doing this for different values of embedding dimensions, we will get r values which when ploted against corresponding embedding dimension would look like the following figure:</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/SwaragThaikkandi/SMdRQA/main/docs/chapters/figs/23_Embedding_Dim_Hitts_Zero.png"><img alt="https://raw.githubusercontent.com/SwaragThaikkandi/SMdRQA/main/docs/chapters/figs/23_Embedding_Dim_Hitts_Zero.png" class="align-center" src="https://raw.githubusercontent.com/SwaragThaikkandi/SMdRQA/main/docs/chapters/figs/23_Embedding_Dim_Hitts_Zero.png" style="width: 800px;" />
</a>
<p>Here, we can see that, after a point, the curve shallows down, that is we can assume that the attractor had fairly unfolded. For getting this value of <span class="math notranslate nohighlight">\(m\)</span>, we need to find the knee point of this monotonously decreasing curve. This could be done by choosing a termination criteria like the following:</p>
<div class="math notranslate nohighlight">
\[m = \{ \text{max}(m') \mid r_{0}(m'-1) - r_{0}(m') \geq \beta \}\]</div>
<p>Which was implemented using the function <strong>findm()</strong>.</p>
</section>
<section id="findm">
<h2><em>findm()</em><a class="headerlink" href="#findm" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMdRQA.RQA_functions.findm">
<span class="sig-name descname"><span class="pre">findm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdiv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/SMdRQA/RQA_functions.html#findm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMdRQA.RQA_functions.findm" title="Link to this definition">#</a></dt>
<dd><p>Function that finds the value of m whre the r at which FNN ratio hits zero vs m curve flattens(defined by bound value)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>ndarray</em>) – double array of shape (n,d).  Think of it as n points in a d dimensional space</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of samples or observations in the time series</p></li>
<li><p><strong>d</strong> (<em>int</em>) – number of measurements or dimensions of the data</p></li>
<li><p><strong>tau</strong> (<em>int</em>) – amount of delay</p></li>
<li><p><strong>m</strong> (<em>int</em>) – number of embedding dimensions</p></li>
<li><p><strong>r</strong> (<em>double</em>) – ratio parameter</p></li>
<li><p><strong>sig</strong> (<em>double</em>) – standard deviation of the data</p></li>
<li><p><strong>delta</strong> (<em>double</em>) – the tolerance value(the maximum difference from zero) for a value of FNN ratio to be effectively considered to be zero</p></li>
<li><p><strong>Rmin</strong> (<em>double</em>) – minimum value of r from where we would start the parameter search</p></li>
<li><p><strong>Rmax</strong> (<em>double</em>) – maximum value of r for defining the upper limit of parameter search</p></li>
<li><p><strong>rdiv</strong> (<em>Int</em>) – number of divisions between Rmin and Rmax for parameter search</p></li>
<li><p><strong>bound</strong> (<em>double</em>) – bound value for terminating the parameter serch</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>m</strong> (<em>double</em>) – value of embedding dimension</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Kantz, H., &amp; Schreiber, T. (2004). Nonlinear time series analysis (Vol. 7). Cambridge university press. section 3.3.1</p></li>
</ul>
</dd></dl>

<p>Now we have two important parameters for time delayed embedding, <span class="math notranslate nohighlight">\(tau\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 2- Taken’s Theorm and Time Delayed Embedding</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 4- Recurrence Plot and Recurrence Quantification Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest"><em>nearest()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.nearest"><code class="docutils literal notranslate"><span class="pre">nearest()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fnnhitszero"><em>fnnhitszero()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.fnnhitszero"><code class="docutils literal notranslate"><span class="pre">fnnhitszero()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#findm"><em>findm()</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMdRQA.RQA_functions.findm"><code class="docutils literal notranslate"><span class="pre">findm()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Swarag Thaikkandi, Miss Nivedita, K.M Sharika. This documentation is licensed under a <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPL-3</a> license.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>